# 도커 개념 및 활용
- 개발환경 동일하게 재현하기 위함
- 컨테이너와 도커
- Docker Desktop과 설치
- Docker 기본 명령어
- Docker compose 실습

## 컨테이너와 도커
- 도커
    - 도커(Docker)
        - 애플리케이션을 컨테이너라는 가볍고 독립적인 환경에서 실행할 수 있도록 도와주는 오픈소스 가상화 플랫폼
        - 외부 환경과 격리된 상태에서 애플리케이션이 환경에 영향 받지 않고 실행될 수 있도록 하는 소프트웨어
        - 컨테이너를 생성하고, 관리하는 데 필요한 엔진과 명령줄 도구(CLI)로 구성

- 컨테이너
    - 정의
        - 어떤 물체나 데이터를 외부와 분리된 공간에 담아두는 것
        - 물체를 격리하는 공간과 비슷한 의미
    - 필요성
        - 환경 차이 없이 어디서든 실행 가능
            - ex: 개발 PC, 테스트 서버, 클라우드에서도 동일하게 동작
        - 설치/설정 충돌 방지
            - 여러 맵이 공존할 수 있는 안전한 격리 공간 제공
        - 빠른 실행과 이식성
            - 가상머신보다 훨씬 빠르게 실행되고 리소스도 적게 사용
    - 개념
        - CLIENT(명령)
            - 터미널, REMOTE API
        - DAEMON(핵심엔진 역할)
            - containers
                - 실행, 중지, 삭제
            - images
        - REGISTRY(사용)
            - HUB

- 도커의 핵심 구성 요소
    - 도커 엔진(Docker Engine)
        - Docker의 중심이 되는 실행 시스템
        - 컨테이너를 실제로 생성하고 실행하는 역할을 맡음
        - dockerd라는 데몬(서버)이 Docker API 요청을 받아 처리
        - 예를 들어, '컨테이너를 하나 만들어줘', '이 이미지를 실행해줘' 같은 명령이 여기에 전달되어 실행
    - 도커 클라이언트(Docker Client)
        - 우리가 터미널에서 입력하는 docker 명령어가 여기에 해당
        - 사용자가 입력한 명령은 내부적으로 Docker Engine에 전달
        - 실제로 작업을 수행하는 것은 엔진이고, 클라이언트는 이를 요청하는 창구 역할을 함
        - 예: docker run, docker ps, docker build 등
    - 도커 객체(Docker Objects)
        - Docker에서 다루는 주요 구성 단위
        - image (이미지): 컨테이너를 만들기 위한 설계도 역할
        - Container (컨테이너): 이미지를 실제로 실행한 실체
        - Service (서비스): 여러 개의 컨테이너를 묶어 하나의 서비스처럼 운영하는 단위(Docker Swarm, k8s)
        - 이러한 객체들을 조합해 하나의 시스템을 구성
    - 도커 레지스트리(Docker Registry)
        - 이미지를 저장하고 공유할 수 있는 중앙 저장소
        - 가장 대표적인 예는 Docker Hub
        - 사용자는 docker pull로 이미지를 내려받고, docker push로 자신이 만든 이미지를 업로드할 수 있음
    
- Dockerfile, Docker Image, Docker Container의 관계
    - 도커 파일(Dockerfile)
        - Dockerfile은 이미지를 만들기 위한 설계도
        - 우리가 원하는 환경과 명령들을 스크립트 형식으로 장석한다.
        - ex) 어떤 OS를 쓸지, 어떤 파일을 복사할지, 어떤 명령어를 실행할지를 기록
    - 도커 이미지(Docker Image)
        - 이미지는 하나의 정적인 파일로, 실행할 준비가 된 상태의 환경
        - docker build 명령을 통해 Dockerfile로 부터 이미지를 생성
        - 내부에는 다음과 같은 정보가 포함
            - OS(기반 계층, ex: Ubuntu)
            - 소스코드, 의존성, 환경변수, 실행 명령어 등
    - 도커 컨테이너(Docker Container)
        - 컨테이너는 이미지의 복사본이 메모리에서 실행 중인 상태
        - 이미지를 docker run하면 컨테이너가 생성
        - 내부에서는 실제 애플리케이션이 돌아감
        - 각 컨테이너는 자신만의 파일시스템과 프로세스를 가짐 (다른 컨테이너와 격리)

- 도커 관련 주요 도구
    - 도커 컴포즈(Docker Compose)
        - 여러 개의 컨테이너를 한 번에 실행하고 관리할 수 있는 도구
        - docker-compose.yml 파일에 컨테이너 구성과 관계를 정의
        - 다른 여러 종류의 서버를 하나의 시스템처럼 묶어서 실행

## Docker Desktop 설치

## Docker Compose
- Docker Compose 개요
    - 정의
        - Docker Compose는 여러 컨테이너를 하나의 프로젝트처럼 관리할 수 있게 해주는 도구
        - docker-compose.yml 파일에 정의된 내용을 바탕으로 한번에 컨테이너들을 실행
    - docker-compose.yml 구조
        - services: 컨테이너 목록
        - image: 사용할 도커 이미지
        - ports: 호스트와 컨테이너의 포트 매핑
    - Docker compose 명령어
        - docker compose up -d : 백그라운드 실행
        - docker ccompose ps : 실행 중인 서비스 확인
        - docker compose down : 컨테이너, 네트워크 정리
- Docker Compose 네트워크
    - 같은 Compose 파일 내 네트워크
        - docker compose up을 실행하면 자동으로 프로젝트 이름 기반의 네트워크가 생성
        - 같은 docker-compose.yml 내 서비스들은 동일 네트워크를 공유하므로 통신 가능
        - 서비스명으로 접근 권장
            - Docker가 자동으로 DNS를 관리하므로, db 서비스 -> IP보다 db라는 이름으로 접근하는 것이 일반적이고 안전(IP는 컨테이너 재시작 시 바뀔 수 있음)
    - 다른 Compose 프로젝트 간 네트워크
        - 기본적으로 프로젝트 간 네트워크는 분리되어 서로 통신할 수 없음
        - 하지만 명시적으로 같은 사용자 정의 네트워크를 지정하면 서로 통신 가능
        - 두 개의 서로 다른 docker-compose.yml에서 동일한 미리 만든 외부 브리지 네트워크에 external: true 옵션을 사용하면 IP/서비스명 공유
        - 서비스명으로 접근할 때는 동일 네트워크 내에서만 가능하고, 외부 네트워크 간 통신을 위해선 명시적으로 네트워크를 설정 필요